<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Norway soil metanetwork analysis • metanetwork</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Norway soil metanetwork analysis">
<meta property="og:description" content="metanetwork">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metanetwork</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pyramid.html">The pyramid example</a>
    </li>
    <li>
      <a href="../articles/angola.html">The Angola dataset</a>
    </li>
    <li>
      <a href="../articles/norway.html">The Norway dataset</a>
    </li>
    <li>
      <a href="../articles/vertebrates.html">The metaweb of European vertebrates</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MarcOhlmann/metanetwork/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Norway soil metanetwork analysis</h1>
                        <h4 data-toc-skip class="author">Marc
Ohlmann</h4>
            
            <h4 data-toc-skip class="date">2023-05-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MarcOhlmann/metanetwork/blob/HEAD/vignettes/norway.Rmd" class="external-link"><code>vignettes/norway.Rmd</code></a></small>
      <div class="hidden name"><code>norway.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="norway-soil-metanetwork-data-set">Norway soil metanetwork data set<a class="anchor" aria-label="anchor" href="#norway-soil-metanetwork-data-set"></a>
</h2>
<p>Norway soil metanetwork dataset was extracted from <em>Calderon-Sanou
et al. 2021</em>. It consists in a soil expert knowledge metaweb that
contains <span class="math inline">\(40\)</span> tropho-functional
groups and <span class="math inline">\(204\)</span> interactions.
Tropho-functional groups have abundance data built from eDNA data in
disturbed and non-disturbed sites by moth outbreaks. This dataset also
contains a trophic table that contains broader taxonomic and functional
informations on groups.</p>
<p>In this vignette, we aim at represent metaweb at different
aggregation levels and compare local networks with layouts provided by
‘metanetwork’.</p>
</div>
<div class="section level2">
<h2 id="loading-the-dataset">Loading the dataset<a class="anchor" aria-label="anchor" href="#loading-the-dataset"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MarcOhlmann/metanetwork" class="external-link">metanetwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"meta_norway"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "metanetwork"</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## metaweb has 40 nodes and 204 edges </span></span>
<span><span class="co">## 2 local networks </span></span>
<span><span class="co">## available resolutions (not computed) are: trophic_group trophic_class taxa</span></span></code></pre>
<div class="section level3">
<h3 id="plot_trophic_table-function">
<code>plot_trophic_table</code> function<a class="anchor" aria-label="anchor" href="#plot_trophic_table-function"></a>
</h3>
<p>Trophic table describes nodes memberships in higher relevant groups.
In angola dataset, two different taxonomic resolutions are available.
Networks can be handled and represented at trophic class or trophic
group level.<br>
The <code>plot_trophic_table</code> function allows representing the
tree describing species memberships.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ggnet.custom</span> <span class="op">=</span> <span class="va">ggnet.default</span></span>
<span><span class="va">ggnet.custom</span><span class="op">$</span><span class="va">label.size</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="fu"><a href="../reference/plot_trophicTable.html">plot_trophicTable</a></span><span class="op">(</span><span class="va">meta_norway</span>,res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'trophic_group'</span>,<span class="st">'trophic_class'</span><span class="op">)</span>,ggnet.config <span class="op">=</span> <span class="va">ggnet.custom</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/norway_plot_trophic_table-1.png" alt=""><p class="caption">plot of chunk norway_plot_trophic_table</p>
</div>
</div>
<div class="section level3">
<h3 id="append_agg_nets-method">
<code>append_agg_nets</code> method<a class="anchor" aria-label="anchor" href="#append_agg_nets-method"></a>
</h3>
<p>The method <code>append_agg_nets</code> allows computing and
appending aggregated networks (at the different available resolutions
shown by <code>plot_trophic_table</code>) to the current
metanetwork.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta_norway</span> <span class="op">=</span> <span class="fu"><a href="../reference/append_agg_nets.html">append_agg_nets</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## metaweb has 40 nodes and 204 edges </span></span>
<span><span class="co">## 2 local networks </span></span>
<span><span class="co">## available resolutions are: trophic_group trophic_class taxa</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="represent-the-metaweb-at-several-resolutions">Represent the metaweb at several resolutions<a class="anchor" aria-label="anchor" href="#represent-the-metaweb-at-several-resolutions"></a>
</h2>
<div class="section level3">
<h3 id="representing-aggregated-networks-adding-a-legend-to-networks">Representing aggregated networks, adding a legend to networks<a class="anchor" aria-label="anchor" href="#representing-aggregated-networks-adding-a-legend-to-networks"></a>
</h3>
<p>Once computed, <code>ggmetanet</code> function allows representing
aggregated networks and legending local networks using trophic table
using ‘ggnet’ visualisation. Do not forget to first compute trophic
levels. Computation of ‘TL-tsne’ layout is done <code>ggmetanet</code>
function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta_norway</span> <span class="op">=</span> <span class="fu"><a href="../reference/compute_TL.html">compute_TL</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggmetanet.html">ggmetanet</a></span><span class="op">(</span>g <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb_trophic_class</span>,beta <span class="op">=</span> <span class="fl">0.2</span>,metanetwork <span class="op">=</span> <span class="va">meta_norway</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/norway_metaweb_trophic_class-1.png" alt=""><p class="caption">plot of chunk norway_metaweb_trophic_class</p>
</div>
<p>Node sizes are proportional to relative abundances. Trophic table
allows adding a legend to network at the finest resolution.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ggnet.custom</span> <span class="op">=</span> <span class="va">ggnet.default</span></span>
<span><span class="va">ggnet.custom</span><span class="op">$</span><span class="va">label.size</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="fu"><a href="../reference/ggmetanet.html">ggmetanet</a></span><span class="op">(</span>g <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb</span>,beta <span class="op">=</span> <span class="fl">0.006</span>,legend <span class="op">=</span> <span class="st">'taxa'</span>,metanetwork <span class="op">=</span> <span class="va">meta_norway</span>, ggnet.config <span class="op">=</span> <span class="va">ggnet.custom</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/norway_metaweb-1.png" alt=""><p class="caption">plot of chunk norway_metaweb</p>
</div>
<p>The metaweb has two basal resources: plant and organic material. They
have the lowest x-axis values in the ‘TL-tsne’ layout. The channel
starting from plants corresponds to the green energy channel while the
channel starting from organic materials is the brown channel.
Importantly, we observe from our network representation that bacterial
and fungal paths are separated in the brown channel. It means that they
are linked to separated paths higher up in the network (e.g. bacterivore
and fungivore groups)</p>
</div>
<div class="section level3">
<h3 id="attaching-layout">Attaching layout<a class="anchor" aria-label="anchor" href="#attaching-layout"></a>
</h3>
<p>Since <code>TL-tsne</code> layout is stochastic and requires (a bit
of) computation times, saving and using the the same layout (for a given
<span class="math inline">\(\beta\)</span> value) is recommended.
Moreover, it makes easier visual network analysis and comparison since
it is fixed. <code>attach_layout</code> function allows saving computed
layouts by attaching them as a node attribute.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#attaching 'TL-tsne' layout to the metaweb</span></span>
<span><span class="va">meta_norway</span> <span class="op">=</span> <span class="fu"><a href="../reference/attach_layout.html">attach_layout</a></span><span class="op">(</span>metanetwork <span class="op">=</span> <span class="va">meta_norway</span>,beta <span class="op">=</span> <span class="fl">0.006</span><span class="op">)</span></span>
<span><span class="co">#TL-tsne layout is stored as node attribute</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/vertex_attr_names.html" class="external-link">vertex_attr_names</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "name"             "ab"               "TL"               "layout_beta0.006"</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#get the layout</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb</span><span class="op">)</span><span class="op">$</span><span class="va">layout_beta0.006</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] -12.9475056  -8.0027108 -16.2079443 -22.7132091 -11.3462398 -20.1130143  -6.5106735   9.9233144  -4.5854150  -2.0651410 -14.1010060   1.0591155</span></span>
<span><span class="co">## [13]   4.2481564 -18.2430818   2.8069118  22.6621553  12.6249591   5.3913804   6.2461442  -0.2074156   7.6423898  -9.8195071 -32.2030752  14.0077834</span></span>
<span><span class="co">## [25]  17.4103375  11.2056083   8.5513003  19.8232874  15.6005706  29.1014202  -9.5435798 -27.9502300   1.4803516  34.2080994  -6.0977349  -1.5314268</span></span>
<span><span class="co">## [37]  -3.3362833 -25.0019387   3.4444592  25.0893880</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Represent the metaweb with the computed layout</span></span>
<span><span class="fu"><a href="../reference/ggmetanet.html">ggmetanet</a></span><span class="op">(</span>g <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb</span>,beta <span class="op">=</span> <span class="fl">0.006</span>,legend <span class="op">=</span> <span class="st">'taxa'</span>,metanetwork <span class="op">=</span> <span class="va">meta_norway</span>, ggnet.config <span class="op">=</span> <span class="va">ggnet.custom</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/norway_attach_layout-1.png" alt=""><p class="caption">plot of chunk norway_attach_layout</p>
</div>
<p>Using <code>attach_layout</code>, you can compute several layouts for
the same <span class="math inline">\(\beta\)</span> value.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># attaching a new 'TL-tsne' layout to the metaweb</span></span>
<span><span class="va">meta_norway</span> <span class="op">=</span> <span class="fu"><a href="../reference/attach_layout.html">attach_layout</a></span><span class="op">(</span>metanetwork <span class="op">=</span> <span class="va">meta_norway</span>,beta <span class="op">=</span> <span class="fl">0.006</span><span class="op">)</span></span>
<span><span class="co"># the new TL-tsne layout is stored as node attribute</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/vertex_attr_names.html" class="external-link">vertex_attr_names</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "name"               "ab"                 "TL"                 "layout_beta0.006"   "layout_beta0.006_1"</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the new layout</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb</span><span class="op">)</span><span class="op">$</span><span class="va">layout_beta0.006_1</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] -11.3292919  -6.2404344 -14.4904523 -20.7829565  -9.7811898 -18.2751020  -8.2376113  14.2437126  -3.1185555  -0.5114248 -12.4205135   2.8892467</span></span>
<span><span class="co">## [13]   6.7630146 -16.4638242   4.8245507  24.6439560  11.5016087   5.8200419   7.9570338   1.3369044   9.2702139  -4.9686021 -33.2063100  19.0852838</span></span>
<span><span class="co">## [25]  12.8683306  10.0729920  15.5970396  21.5980855  17.2236436 -25.4482627  -7.7653373 -28.8226861   3.7008810  32.6364900  -4.5686339  -0.1325995</span></span>
<span><span class="co">## [37]  -1.8834867 -22.9474544   2.0567619  27.3049378</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Represent the metaweb with the computed layout</span></span>
<span><span class="fu"><a href="../reference/ggmetanet.html">ggmetanet</a></span><span class="op">(</span>g <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb</span>,beta <span class="op">=</span> <span class="fl">0.006</span>,legend <span class="op">=</span> <span class="st">'taxa'</span>,metanetwork <span class="op">=</span> <span class="va">meta_norway</span>, ggnet.config <span class="op">=</span> <span class="va">ggnet.custom</span>,nrep_ly <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/norway_attach_layout2-1.png" alt=""><p class="caption">plot of chunk norway_attach_layout2</p>
</div>
<p>We see that even if the two layouts for the same <span class="math inline">\(\beta\)</span> value are different, they share
some structural characteristics. For example, fungal and bacterial
groups are clustered together and are linked to their corresponding
consumers (fungivore and bacterivore).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#attaching 'TL-tsne' layout to metaweb at class level</span></span>
<span><span class="va">meta_norway</span> <span class="op">=</span> <span class="fu"><a href="../reference/attach_layout.html">attach_layout</a></span><span class="op">(</span>metanetwork <span class="op">=</span> <span class="va">meta_norway</span>,g <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb_trophic_class</span>,beta <span class="op">=</span> <span class="fl">0.006</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggmetanet.html">ggmetanet</a></span><span class="op">(</span>g <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb_trophic_class</span>,beta <span class="op">=</span> <span class="fl">0.006</span>,metanetwork <span class="op">=</span> <span class="va">meta_norway</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/norway_attach_layout3-1.png" alt=""><p class="caption">plot of chunk norway_attach_layout3</p>
</div>
</div>
<div class="section level3">
<h3 id="group-tl-tnse-layout">‘group-TL-tnse’ layout<a class="anchor" aria-label="anchor" href="#group-tl-tnse-layout"></a>
</h3>
<p>A variation of <code>'TL-tsne'</code> layout consists in
<code>'group-TL-tsne'</code> layout. It mixes <code>'TL-tsne'</code> and
a regular <code>igraph</code> layout to provide a representation where
species from the same group are clustered together. Such approach
provides more stable and interpretable. Morever, it is more efficient in
terms of computation time since it only requires <code>'TL-tsne'</code>
layout computation at the aggregated level instead of computing it in
higher dimension at the group level. <code>'group-TL-tsne'</code> layout
is stored as node attribute.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta_norway</span> <span class="op">=</span> <span class="fu"><a href="../reference/attach_layout.html">attach_layout</a></span><span class="op">(</span><span class="va">meta_norway</span>,beta <span class="op">=</span> <span class="fl">0.2</span>,mode <span class="op">=</span> <span class="st">"group-TL-tsne"</span>,res <span class="op">=</span> <span class="st">"trophic_class"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/vertex_attr_names.html" class="external-link">vertex_attr_names</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">$</span><span class="va">metaweb</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "name"                   "ab"                     "TL"                     "layout_beta0.006"       "layout_beta0.006_1"     "group_layout_x_beta0.2"</span></span>
<span><span class="co">## [7] "group_layout_y_beta0.2"</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggmetanet.html">ggmetanet</a></span><span class="op">(</span><span class="va">meta_norway</span>,beta <span class="op">=</span> <span class="fl">0.2</span>,mode <span class="op">=</span> <span class="st">"group-TL-tsne"</span>,legend <span class="op">=</span> <span class="st">"trophic_class"</span>,ggnet.config <span class="op">=</span> <span class="va">ggnet.custom</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/norway_metaweb_group_TL_tsne-1.png" alt=""><p class="caption">plot of chunk norway_metaweb_group_TL_tsne</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="representing-and-comparing-local-networks">Representing and comparing local networks<a class="anchor" aria-label="anchor" href="#representing-and-comparing-local-networks"></a>
</h2>
<p><code>diff_plot</code> allows comparing local networks. Here, it
provides a comparison between high and low disturbed sites by moth
outbreaks.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/diff_plot.html">diff_plot</a></span><span class="op">(</span>g1 <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">high</span>,g2 <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">low</span>,beta <span class="op">=</span> <span class="fl">0.006</span>,metanetwork <span class="op">=</span> <span class="va">meta_norway</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## mode is TL-tsne</span></span></code></pre>
<pre><code><span><span class="co">## plotting: high_trophic_group - low_trophic_group</span></span></code></pre>
<pre><code><span><span class="co">## mode is TL-tsne</span></span></code></pre>
<pre><code><span><span class="co">## beta = 0.006</span></span></code></pre>
<pre><code><span><span class="co">## Epoch: Iteration #100 error is: 1333.49922010638</span></span></code></pre>
<pre><code><span><span class="co">## Epoch: Iteration #200 error is: 319.518122109745</span></span></code></pre>
<pre><code><span><span class="co">## Epoch: Iteration #300 error is: 319.65237149482</span></span></code></pre>
<div class="figure">
<img src="figure/norway_diffplot-1.png" alt=""><p class="caption">plot of chunk norway_diffplot</p>
</div>
<p>It highlights a shift from Ectomycorrhizae and Ericoid mycorrhizae
towards Arbuscular mycorrhizae due to increase of shrubs after the
perturbation and also an increase in soil predator abundances. Here, a
new ‘TL-tsne’ layout is computed.</p>
<div class="section level3">
<h3 id="using-metaweb-layout">Using metaweb layout<a class="anchor" aria-label="anchor" href="#using-metaweb-layout"></a>
</h3>
<p>In order to gain reproducibility and not to compute
<code>'TL-tsne'</code> layout at each call, use argument
<code>layout_metaweb = T</code> to represent the difference network with
metaweb layout.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/diff_plot.html">diff_plot</a></span><span class="op">(</span>g1 <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">high</span>,g2 <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">low</span>,beta <span class="op">=</span> <span class="fl">0.006</span>,metanetwork <span class="op">=</span> <span class="va">meta_norway</span>,layout_metaweb <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## mode is TL-tsne</span></span></code></pre>
<pre><code><span><span class="co">## plotting: high_trophic_group - low_trophic_group</span></span></code></pre>
<pre><code><span><span class="co">## mode is TL-tsne</span></span></code></pre>
<div class="figure">
<img src="figure/norway_diff_plot-1.png" alt=""><p class="caption">plot of chunk norway_diff_plot</p>
</div>
</div>
<div class="section level3">
<h3 id="using-group-tl-tsne-layout">Using <code>'group-TL-tsne'</code> layout<a class="anchor" aria-label="anchor" href="#using-group-tl-tsne-layout"></a>
</h3>
<p>Once computed on the metaweb, <code>'group-TL-tsne'</code> layout can
be used in <code>'diff_plot'</code></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ggnet.custom</span><span class="op">$</span><span class="va">arrow.size</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="va">ggnet.custom</span><span class="op">$</span><span class="va">edge.alpha</span> <span class="op">=</span> <span class="fl">0.2</span></span>
<span></span>
<span><span class="fu"><a href="../reference/diff_plot.html">diff_plot</a></span><span class="op">(</span>g1 <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">high</span>,g2 <span class="op">=</span> <span class="va">meta_norway</span><span class="op">$</span><span class="va">low</span>,beta <span class="op">=</span> <span class="fl">0.2</span>, mode <span class="op">=</span> <span class="st">"group-TL-tsne"</span>,</span>
<span>          metanetwork <span class="op">=</span> <span class="va">meta_norway</span>,layout_metaweb <span class="op">=</span> <span class="cn">T</span>,ggnet.config <span class="op">=</span> <span class="va">ggnet.custom</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## mode is group-TL-tsne</span></span></code></pre>
<pre><code><span><span class="co">## plotting: high_trophic_group - low_trophic_group</span></span></code></pre>
<pre><code><span><span class="co">## mode is group-TL-tsne</span></span></code></pre>
<div class="figure">
<img src="figure/norway_diffplot_group_layout-1.png" alt=""><p class="caption">plot of chunk norway_diffplot_group_layout</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="computing-network-indices-and-metrics">Computing network indices and metrics<a class="anchor" aria-label="anchor" href="#computing-network-indices-and-metrics"></a>
</h2>
<p>Besides network representation, ‘metanetwork’ package can compute
usual network metrics (weighted connectance, mean and max trophic level,
mean shortest path length). Network diversity and dissimilarity indices
based on Hill numbers are also implemented in order to quantitatively
compare local networks at the different resolutions.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metrics_norway</span> <span class="op">=</span> <span class="fu"><a href="../reference/compute_metrics.html">compute_metrics</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in t(igraph::V(g)$ab) %*% adj: arguments inadéquats</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#metrics at the different resolutions</span></span>
<span><span class="va">metrics_norway</span><span class="op">$</span><span class="va">trophic_group</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): objet 'metrics_norway' introuvable</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metrics_norway</span><span class="op">$</span><span class="va">trophic_class</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): objet 'metrics_norway' introuvable</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metrics_norway</span><span class="op">$</span><span class="va">taxa</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): objet 'metrics_norway' introuvable</span></span></code></pre>
<p>We now compute network diversity indices based on Hill numbers
(cf. Ohlmann et al. 2019). The indices are based on node and link
abundances are can be partitioned in <span class="math inline">\(\alpha\)</span>-diversity, <span class="math inline">\(\beta\)</span>-diversity and <span class="math inline">\(\gamma\)</span>-diversity. A viewpoint parameter
<span class="math inline">\(q\)</span> allows giving more weight (see
<code>compute_div</code> documentation)</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">div_norway</span> <span class="op">=</span> <span class="fu"><a href="../reference/compute_div.html">compute_div</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">)</span></span>
<span></span>
<span><span class="va">div_norway</span><span class="op">$</span><span class="va">nodes</span></span></code></pre></div>
<pre><code><span><span class="co">##              trophic_group trophic_class     taxa</span></span>
<span><span class="co">## Gamma_P          17.166819      4.637323 3.865180</span></span>
<span><span class="co">## mean_Alpha_P     16.645513      4.600212 3.847461</span></span>
<span><span class="co">## Beta_P            1.031318      1.008067 1.004605</span></span>
<span><span class="co">## Alpha_high_P     17.833549      4.650241 3.924770</span></span>
<span><span class="co">## Alpha_low_P      15.536622      4.550721 3.771674</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">div_norway</span><span class="op">$</span><span class="va">links</span></span></code></pre></div>
<pre><code><span><span class="co">##              trophic_group trophic_class     taxa</span></span>
<span><span class="co">## Gamma_L          52.899140      8.044432 9.227551</span></span>
<span><span class="co">## mean_Alpha_L     48.298149      7.918602 9.093270</span></span>
<span><span class="co">## Beta_L            1.095262      1.015890 1.014767</span></span>
<span><span class="co">## Alpha_high_L     63.542723      8.410311 9.868439</span></span>
<span><span class="co">## Alpha_low_L      36.710910      7.455640 8.378992</span></span></code></pre>
<p>As reported in Calderon-Sanou et al. 2021, we see higher node and
link diversities in sites with a high perturbation level. This is due to
the fact that dominant groups tend to to disappear, giving way to an
increase in predator groups and leading so to more evenly distributed
abundances. Pairwise dissimilarity indices (both on nodes and links) are
also implemented in metanetwork (see <code>compute_dis</code>
documentation).</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dis_norway</span> <span class="op">=</span> <span class="fu"><a href="../reference/compute_dis.html">compute_dis</a></span><span class="op">(</span><span class="va">meta_norway</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#nodes and links dissimilarity at Species resolution</span></span>
<span><span class="va">dis_norway</span><span class="op">$</span><span class="va">trophic_group</span><span class="op">$</span><span class="va">nodes</span></span></code></pre></div>
<pre><code><span><span class="co">##            high        low</span></span>
<span><span class="co">## high 0.00000000 0.04448943</span></span>
<span><span class="co">## low  0.04448943 0.00000000</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dis_norway</span><span class="op">$</span><span class="va">trophic_group</span><span class="op">$</span><span class="va">links</span></span></code></pre></div>
<pre><code><span><span class="co">##           high       low</span></span>
<span><span class="co">## high 0.0000000 0.1312764</span></span>
<span><span class="co">## low  0.1312764 0.0000000</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#nodes and links dissimilarity at Phylum resolution</span></span>
<span><span class="va">dis_norway</span><span class="op">$</span><span class="va">trophic_class</span><span class="op">$</span><span class="va">nodes</span></span></code></pre></div>
<pre><code><span><span class="co">##            high        low</span></span>
<span><span class="co">## high 0.00000000 0.01159194</span></span>
<span><span class="co">## low  0.01159194 0.00000000</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dis_norway</span><span class="op">$</span><span class="va">trophic_class</span><span class="op">$</span><span class="va">links</span></span></code></pre></div>
<pre><code><span><span class="co">##            high        low</span></span>
<span><span class="co">## high 0.00000000 0.02274482</span></span>
<span><span class="co">## low  0.02274482 0.00000000</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compute dissimilarity at taxa resolution only</span></span>
<span><span class="fu"><a href="../reference/compute_dis.html">compute_dis</a></span><span class="op">(</span><span class="va">meta_norway</span>,res <span class="op">=</span> <span class="st">"taxa"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $taxa</span></span>
<span><span class="co">## $taxa$nodes</span></span>
<span><span class="co">##             high         low</span></span>
<span><span class="co">## high 0.000000000 0.006628866</span></span>
<span><span class="co">## low  0.006628866 0.000000000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $taxa$links</span></span>
<span><span class="co">##            high        low</span></span>
<span><span class="co">## high 0.00000000 0.02114852</span></span>
<span><span class="co">## low  0.02114852 0.00000000</span></span></code></pre>
<p>We see that networks are more dissimilar at trophic_group compared to
trophic_class resolution both on nodes and links. Moreover, at both
resolutions, network are more dissimilar regarding link abundances
compared to node abundances. To gain in efficiency,
<code>compute_dis</code> is uses parallel computation (see
<code>ncores</code> argument in <code>compute_dis</code>
documentation)</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Calderón-Sanou, I., Münkemüller, T., Zinger, L., Schimann, H.,
Yoccoz, N. G., Gielly, L., … &amp; Thuiller, W. (2021). Cascading
effects of moth outbreaks on subarctic soil food webs. Scientific
Reports, 11(1), 15054.</p></li>
<li><p>Ohlmann, M., Miele, V., Dray, S., Chalmandrier, L., O’connor, L.,
&amp; Thuiller, W. (2019). Diversity indices for ecological networks: a
unifying framework using Hill numbers. Ecology letters, 22(4),
737-747.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Marc Ohlmann, Jimmy Garnier, Laurent Vuillon.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
